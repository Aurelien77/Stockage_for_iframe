<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tests Backend ‚Äì xUnit & Entity Framework</title>

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: Arial, sans-serif;
    background: #f0f9f4;
    padding: 20px;
}

.container {
    max-width: 1400px;
    margin: auto;
    background: white;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.12);
}

/* TITRE */
h1 {
    text-align: center;
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
    padding: 18px;
    border-radius: 8px;
    margin-bottom: 30px;
    animation: fadeIn 1s forwards;
}

/* INTRO */
.intro {
    text-align: center;
    font-size: 15px;
    margin-bottom: 30px;
    color: #333;
}

/* SECTIONS */
.section {
    border: 2px solid #10b981;
    border-radius: 10px;
    margin-bottom: 22px;
    padding: 18px;
    background: #f0fdf4;
    cursor: pointer;
    transition: transform 0.3s, box-shadow 0.3s;
}

.section:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 18px rgba(16, 185, 129, 0.25);
}

.section-title {
    font-size: 18px;
    font-weight: bold;
    color: #047857;
}

/* CONTENU */
.section-content {
    max-height: 0;
    overflow: hidden;
    opacity: 0;
    transition: max-height 0.8s ease, opacity 0.5s ease;
    margin-top: 12px;
    font-size: 14px;
    line-height: 1.7;
}

.section.open .section-content {
    max-height: 1200px;
    opacity: 1;
}

/* BADGES */
.badge {
    display: inline-block;
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
    padding: 4px 10px;
    border-radius: 6px;
    font-size: 12px;
    margin-top: 8px;
}

/* LISTES */
ul {
    margin-left: 20px;
    margin-top: 8px;
}

li {
    margin-bottom: 6px;
}

/* CODE BLOCKS */
code {
    background: #d1fae5;
    padding: 2px 6px;
    border-radius: 4px;
    font-family: 'Courier New', monospace;
    font-size: 13px;
    color: #047857;
}

/* HIGHLIGHT BOX */
.highlight {
    background: #ecfdf5;
    border-left: 4px solid #10b981;
    padding: 12px;
    margin: 12px 0;
    border-radius: 4px;
}

/* FOOTER */
.footer {
    text-align: center;
    margin-top: 30px;
    font-size: 13px;
    color: #555;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}
</style>
</head>

<body>

<div class="container">

<h1>Tests Backend ‚Äì xUnit & Entity Framework</h1>

<div class="intro">
    L'architecture de tests backend s'appuie sur  
    <strong>xUnit, Entity Framework InMemory et des sc√©narios d'int√©gration complets</strong>.
</div>

<!-- SECTION 1 -->
<div class="section">
    <div class="section-title">1Ô∏è‚É£ Framework xUnit</div>
    <div class="section-content">
        <p>xUnit est le framework de tests moderne pour .NET et C#.</p>
        <ul>
            <li>Architecture orient√©e faits (<code>[Fact]</code>)</li>
            <li>Parall√©lisation automatique des tests</li>
            <li>Injection de d√©pendances native</li>
            <li>Sorties de test avec <code>ITestOutputHelper</code></li>
        </ul>
        <p>xUnit garantit des tests rapides, isol√©s et reproductibles.</p>
        <span class="badge">Standard .NET</span>
    </div>
</div>

<!-- SECTION 2 -->
<div class="section">
    <div class="section-title">2Ô∏è‚É£ Base de donn√©es InMemory</div>
    <div class="section-content">
        <p>Entity Framework InMemory simule la base de donn√©es en m√©moire.</p>
        <ul>
            <li>Aucune d√©pendance √† une vraie base de donn√©es</li>
            <li>Tests ultra-rapides (pas d'I/O disque)</li>
            <li>Isolation compl√®te entre les tests</li>
            <li>R√©initialisation automatique via <code>UseInMemoryDatabase()</code></li>
        </ul>
        <div class="highlight">
            <strong>Exemple :</strong> <code>CreateContext("TestDb_FullUserJourney")</code> cr√©e une DB temporaire unique pour chaque test.
        </div>
        <p>Cette approche permet de tester les contr√¥leurs sans infrastructure externe.</p>
        <span class="badge">Tests isol√©s</span>
    </div>
</div>

<!-- SECTION 3 -->
<div class="section">
    <div class="section-title">3Ô∏è‚É£ Tests d'int√©gration complets</div>
    <div class="section-content">
        <p>Les tests simulent des sc√©narios utilisateur r√©els de bout en bout.</p>
        <ul>
            <li><strong>Parcours complet</strong> : Inscription ‚Üí Connexion ‚Üí R√©cup√©ration profil</li>
            <li>Validation des cookies et tokens JWT</li>
            <li>V√©rification de la persistance des donn√©es</li>
            <li>Tests multi-√©tapes avec assertions interm√©diaires</li>
        </ul>
        <div class="highlight">
            <strong>Test phare :</strong> <code>FullUserJourney_RegisterLoginGetProfile_Success()</code>
            <br>Valide l'ensemble du flux d'authentification en 3 √©tapes.
        </div>
        <span class="badge">End-to-End</span>
    </div>
</div>

<!-- SECTION 4 -->
<div class="section">
    <div class="section-title">4Ô∏è‚É£ Tests de s√©curit√©</div>
    <div class="section-content">
        <p>Des tests v√©rifient la robustesse du syst√®me d'authentification.</p>
        <ul>
            <li>Refus de connexion avec mauvais mot de passe</li>
            <li>Validation du hachage des mots de passe</li>
            <li>Protection contre les injections SQL</li>
            <li>V√©rification de l'unicit√© des emails</li>
        </ul>
        <div class="highlight">
            <strong>Test cl√© :</strong> <code>RegisterThenLoginWithWrongPassword_ShouldFail()</code>
            <br>S'assure que les tentatives frauduleuses sont rejet√©es.
        </div>
        <span class="badge">S√©curit√©</span>
    </div>
</div>

<!-- SECTION 5 -->
<div class="section">
    <div class="section-title">5Ô∏è‚É£ Tests de validation</div>
    <div class="section-content">
        <p>Toutes les r√®gles m√©tier sont test√©es exhaustivement.</p>
        <ul>
            <li>Email vide ou invalide ‚Üí rejet√©</li>
            <li>Login trop court (< 3 caract√®res) ‚Üí rejet√©</li>
            <li>Password faible (sans chiffre, majuscule, ou trop court) ‚Üí rejet√©</li>
            <li>Champs requis manquants ‚Üí rejet√©</li>
        </ul>
        <div class="highlight">
            <strong>Test exhaustif :</strong> <code>Registration_AllValidationRules_AreEnforced()</code>
            <br>V√©rifie 7 r√®gles de validation diff√©rentes en un seul test.
        </div>
        <span class="badge">Validation stricte</span>
    </div>
</div>

<!-- SECTION 6 -->
<div class="section">
    <div class="section-title">6Ô∏è‚É£ Tests multi-utilisateurs</div>
    <div class="section-content">
        <p>Des sc√©narios testent la gestion simultan√©e de plusieurs utilisateurs.</p>
        <ul>
            <li>Cr√©ation de 3+ utilisateurs avec emails diff√©rents</li>
            <li>V√©rification de l'unicit√© des IDs</li>
            <li>Isolation des comptes utilisateurs</li>
            <li>Pas de collision de donn√©es</li>
        </ul>
        <div class="highlight">
            <strong>Test :</strong> <code>MultipleUsers_CanRegisterWithDifferentEmails()</code>
            <br>Garantit que plusieurs utilisateurs peuvent coexister sans conflit.
        </div>
        <span class="badge">Concurrence</span>
    </div>
</div>

<!-- SECTION 7 -->
<div class="section">
    <div class="section-title">7Ô∏è‚É£ Tests de charge</div>
    <div class="section-content">
        <p>Des tests de performance √©valuent la capacit√© du syst√®me sous charge.</p>
        <ul>
            <li>Cr√©ation de 50 utilisateurs en boucle</li>
            <li>Mesure du temps d'ex√©cution total</li>
            <li>Calcul de la moyenne par op√©ration</li>
            <li>Assertion sur les performances (< 5 secondes attendu)</li>
        </ul>
        <div class="highlight">
            <strong>Test de charge :</strong> <code>LoadTest_Create50Users_ShouldSucceed()</code>
            <br>V√©rifie que le syst√®me peut g√©rer un volume important rapidement.
        </div>
        <span class="badge">Performance</span>
    </div>
</div>

<!-- SECTION 8 -->
<div class="section">
    <div class="section-title">8Ô∏è‚É£ Mock du contexte HTTP</div>
    <div class="section-content">
        <p>Les tests simulent le contexte HTTP pour tester les cookies et headers.</p>
        <ul>
            <li>Mock de <code>DefaultHttpContext</code></li>
            <li>Simulation de <code>ControllerContext</code></li>
            <li>V√©rification des cookies Set-Cookie</li>
            <li>Test des headers de r√©ponse</li>
        </ul>
        <p>Cette approche permet de tester l'authentification JWT sans serveur web r√©el.</p>
        <span class="badge">Mock HTTP</span>
    </div>
</div>

<!-- SECTION 9 -->
<div class="section">
    <div class="section-title">9Ô∏è‚É£ Assertions et validation de r√©sultats</div>
    <div class="section-content">
        <p>Les tests utilisent des assertions strictes pour valider les r√©sultats.</p>
        <ul>
            <li><code>Assert.IsType&lt;CreatedAtActionResult&gt;()</code> : v√©rifie le type de r√©ponse</li>
            <li><code>Assert.Equal(expected, actual)</code> : compare les valeurs</li>
            <li><code>Assert.NotNull()</code> : garantit la pr√©sence de donn√©es</li>
            <li>D√©s√©rialisation JSON pour valider les r√©ponses complexes</li>
        </ul>
        <p>Chaque assertion garantit que le comportement attendu est respect√©.</p>
        <span class="badge">Fiabilit√©</span>
    </div>
</div>

<!-- SECTION 10 -->
<div class="section">
    <div class="section-title">üîü ITestOutputHelper : Logs d√©taill√©s</div>
    <div class="section-content">
        <p>Les tests g√©n√®rent des logs lisibles pour faciliter le d√©bogage.</p>
        <ul>
            <li>Affichage des √©tapes du test</li>
            <li>Logs des donn√©es cr√©√©es (IDs, emails, tokens)</li>
            <li>Messages de validation ("Connexion r√©ussie", etc.)</li>
            <li>Statistiques de performance pour les tests de charge</li>
        </ul>
        <div class="highlight">
            <strong>Exemple de sortie :</strong>
            <pre style="margin: 8px 0; padding: 8px; background: white; border-radius: 4px; font-size: 12px;">
√âTAPE 1 : Inscription d'un nouvel utilisateur
‚úì Utilisateur cr√©√© avec succ√®s
  ID: 1
  Email: john.doe@example.com
  Login: johndoe

√âTAPE 2 : Connexion avec les identifiants
‚úì Connexion r√©ussie
  UserId: 1
  Token: eyJhbGc...
  Cookie cr√©√©: True
            </pre>
        </div>
        <span class="badge">Tra√ßabilit√©</span>
    </div>
</div>

<!-- SECTION 11 -->
<div class="section">
    <div class="section-title">1Ô∏è‚É£1Ô∏è‚É£ Structure des fichiers de tests</div>
    <div class="section-content">
        <p>Les tests backend sont organis√©s de mani√®re logique et maintenable.</p>
        <ul>
            <li><code>IntegrationTests.cs</code> : Sc√©narios end-to-end complets</li>
            <li><code>FilesControllerTests.cs</code> : Tests du contr√¥leur de fichiers</li>
            <li><code>UsersTest.cs</code> : Tests unitaires du mod√®le utilisateur</li>
            <li><code>ServicesTests.cs</code> : Tests des services m√©tier</li>
            <li><code>ProgramTests.cs</code> : Tests de configuration de l'application</li>
        </ul>
        <p>Chaque fichier couvre un domaine fonctionnel sp√©cifique.</p>
        <span class="badge">Organisation claire</span>
    </div>
</div>

<!-- SECTION 12 -->
<div class="section">
    <div class="section-title">1Ô∏è‚É£2Ô∏è‚É£ Avantages globaux de cette architecture</div>
    <div class="section-content">
        <ul>
            <li><strong>Isolation totale</strong> : Chaque test utilise sa propre DB InMemory</li>
            <li><strong>Rapidit√©</strong> : Pas de d√©pendances externes, tout en m√©moire</li>
            <li><strong>Couverture compl√®te</strong> : Tests unitaires, int√©gration, s√©curit√©, charge</li>
            <li><strong>Reproductibilit√©</strong> : Les tests donnent toujours le m√™me r√©sultat</li>
            <li><strong>Lisibilit√©</strong> : Logs d√©taill√©s avec ITestOutputHelper</li>
            <li><strong>Maintenabilit√©</strong> : Structure claire et bien organis√©e</li>
        </ul>
        <p>Cette architecture de tests garantit la qualit√©, la s√©curit√© et la fiabilit√© du backend en production.</p>
        <span class="badge">Production-ready</span>
    </div>
</div>

<div class="footer">
    Pr√©sentation interactive ‚Äì Cliquez sur chaque section pour afficher les d√©tails  
</div>

</div>

<script>
document.querySelectorAll('.section').forEach(section => {
    section.addEventListener('click', () => {
        section.classList.toggle('open');
    });
});
</script>

</body>
</html>